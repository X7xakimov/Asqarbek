<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8" />
<title>Mnemonika Major – Mashq</title>
<style>
body { background:#111; color:#fff; font-family:Arial; padding:20px; }
.box { background:#222; padding:20px; border-radius:10px; }
button { padding:10px 20px; margin:5px; border:none; border-radius:8px; font-size:16px; }
.green { background:#4CAF50; }
.red { background:#b82c2c; }
select, textarea { width:100%; padding:10px; margin:10px 0; border-radius:8px; }
#numbers { font-size:24px; text-align:center; letter-spacing:3px; margin:15px 0; }
#timer { font-size:40px; text-align:center; margin:10px 0; }
#status { font-size:18px; text-align:center; margin:10px 0; color:#ffcc00; }
</style>
</head>
<body>

<div class="box">
<h2>Mnemonika — Major mashqi (40 Hz)</h2>

<label>Vaqt:</label>
<select id="timeSelect">
<option value="60">1 daqiqa</option>
<option value="180">3 daqiqa</option>
<option value="300">5 daqiqa</option>
<option value="600">10 daqiqa</option>
</select>

<label>Raqamlar soni:</label>
<select id="countSelect">
<option value="20">20 ta</option>
<option value="50">50 ta</option>
<option value="100">100 ta</option>
<option value="150">150 ta</option>
<option value="200">200 ta</option>
</select>

<button class="green" onclick="startSession()">Start</button>
<button class="red" onclick="stopSession()">To‘xtatish</button>
<button onclick="generateNumbers()">Yangi ketma-ketlik</button>

<div id="timer">00:00</div>
<div id="numbers">— — — — —</div>
<div id="status"></div>

<p>Vaqt tugagach yoki tayyor bo‘lsang yoz:</p>
<textarea id="userInput" placeholder="Bu yerga o‘z eslagan raqamlaringni yoz..."></textarea>
<button class="green" onclick="checkNumbers()">Tekshirish</button>
<button class="red" onclick="clearAll()">Tozalash</button>

<div id="result"></div>
</div>

<audio id="hz40" loop>
<source src="40hz.mp3" type="audio/mpeg" />
</audio>

<script>
let generated = [];
let timerInterval;
let timeLeft = 0;
let sessionActive = false;

function generateNumbers() {
    let count = parseInt(document.getElementById("countSelect").value);
    generated = [];
    for (let i = 0; i < count; i++) {
        let num = Math.floor(Math.random() * 90) + 10;
        generated.push(num);
    }
    document.getElementById("numbers").innerText = generated.join(" ");
    document.getElementById("status").innerText = "";
}

function startSession() {
    generateNumbers();
    timeLeft = parseInt(document.getElementById("timeSelect").value);
    document.getElementById("hz40").play();
    sessionActive = true;

    timerInterval = setInterval(() => {
        let m = Math.floor(timeLeft / 60).toString().padStart(2, "0");
        let s = (timeLeft % 60).toString().padStart(2, "0");
        document.getElementById("timer").innerText = `${m}:${s}`;

        if (timeLeft <= 0) {
            stopSession(true);
        }

        timeLeft--;
    }, 1000);
}

function stopSession(timeout = false) {
    clearInterval(timerInterval);
    document.getElementById("hz40").pause();

    if(timeout) {
        document.getElementById("numbers").innerText = "— — — Sessiya tugadi — — —";
        document.getElementById("status").innerText = "";
        alert("⏰ Vaqt tugadi!");
        sessionActive = false;
    } else {
        if(sessionActive) {
            document.getElementById("status").innerText = "⏹ Sessiya to‘xtatildi!";
            sessionActive = false;
        }
    }
}

function checkNumbers() {
    let input = document.getElementById("userInput").value.replace(/\s+/g, "");
    let split = input.match(/.{1,2}/g) || [];
    let resultHTML = "";
    let correct = 0;
    for (let i = 0; i < generated.length; i++) {
        let userVal = split[i] || "__";
        let realVal = generated[i];
        if (userVal == realVal) {
            correct++;
            resultHTML += `<p style='color:#4CAF50'>[${i+1}] ✔️ ${userVal} | to‘g‘ri: ${realVal}</p>`;
        } else {
            resultHTML += `<p style='color:#ff4a4a'>[${i+1}] ❌ ${userVal} | to‘g‘ri: ${realVal}</p>`;
        }
    }
    resultHTML += `<h3>Jami to‘g‘ri: ${correct} / ${generated.length}</h3>`;
    document.getElementById("result").innerHTML = resultHTML;
}

function clearAll() {
    document.getElementById("userInput").value = "";
    document.getElementById("result").innerHTML = "";
    document.getElementById("status").innerText = "";
}
</script>

</body>
</html>
